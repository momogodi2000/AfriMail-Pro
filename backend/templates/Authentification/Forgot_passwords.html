<!DOCTYPE html>
<html lang="fr" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AfriMail Pro - Mot de passe oublié</title>
    <meta name="description" content="Réinitialisez votre mot de passe AfriMail Pro et retrouvez l'accès à votre compte.">
    
    <!-- Preload critical resources -->
    <link rel="preload" href="https://cdn.tailwindcss.com" as="script">
    <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" as="style">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'african-gold': '#FFD700',
                        'safari-green': '#228B22',
                        'sunset-orange': '#FF6B35',
                        'earth-brown': '#8B4513',
                        'sky-blue': '#87CEEB'
                    },
                    animation: {
                        'float': 'float 6s ease-in-out infinite',
                        'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                        'slide-up': 'slideUp 0.8s ease-out forwards',
                        'slide-down': 'slideDown 0.8s ease-out forwards',
                        'fade-in': 'fadeIn 1s ease-out forwards',
                        'bounce-gentle': 'bounceGentle 2s ease-in-out infinite',
                        'shake': 'shake 0.5s ease-in-out'
                    },
                    keyframes: {
                        float: {
                            '0%, 100%': { transform: 'translatey(0px)' },
                            '50%': { transform: 'translatey(-20px)' }
                        },
                        slideUp: {
                            '0%': { opacity: '0', transform: 'translateY(30px)' },
                            '100%': { opacity: '1', transform: 'translateY(0)' }
                        },
                        slideDown: {
                            '0%': { opacity: '0', transform: 'translateY(-30px)' },
                            '100%': { opacity: '1', transform: 'translateY(0)' }
                        },
                        fadeIn: {
                            '0%': { opacity: '0' },
                            '100%': { opacity: '1' }
                        },
                        bounceGentle: {
                            '0%, 100%': { transform: 'translateY(0)' },
                            '50%': { transform: 'translateY(-10px)' }
                        },
                        shake: {
                            '0%, 100%': { transform: 'translateX(0)' },
                            '25%': { transform: 'translateX(-5px)' },
                            '75%': { transform: 'translateX(5px)' }
                        }
                    }
                }
            }
        }
    </script>
    
    <!-- Font Awesome with defer -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" media="print" onload="this.media='all'">
    <noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"></noscript>
    
    <!-- Inline critical CSS -->
    <style>
        .gradient-text {
            background: linear-gradient(135deg, #FFD700, #FF6B35);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .glass-effect {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .african-pattern {
            background-image: 
                radial-gradient(circle at 20% 80%, rgba(255, 215, 0, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(255, 107, 53, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(34, 139, 34, 0.1) 0%, transparent 50%);
        }
        
        .card-hover {
            transition: all 0.3s ease;
        }
        
        .card-hover:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.15);
        }
        
        .floating-elements {
            position: absolute;
            width: 100%;
            height: 100%;
            overflow: hidden;
            pointer-events: none;
        }
        
        .floating-elements::before,
        .floating-elements::after {
            content: '';
            position: absolute;
            width: 200px;
            height: 200px;
            border-radius: 50%;
            opacity: 0.1;
        }
        
        .floating-elements::before {
            background: linear-gradient(45deg, #FFD700, #FF6B35);
            top: 10%;
            left: 10%;
            animation: float 8s ease-in-out infinite;
        }
        
        .floating-elements::after {
            background: linear-gradient(45deg, #228B22, #87CEEB);
            bottom: 10%;
            right: 10%;
            animation: float 8s ease-in-out infinite reverse;
        }

        .step-hidden {
            display: none;
            opacity: 0;
        }

        .step-visible {
            display: block;
            opacity: 1;
        }

        .progress-bar {
            height: 4px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 2px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #FFD700, #FF6B35);
            border-radius: 2px;
            transition: width 0.5s ease;
        }

        .error-message {
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid rgba(239, 68, 68, 0.3);
            color: #fca5a5;
        }

        .success-message {
            background: rgba(34, 197, 94, 0.1);
            border: 1px solid rgba(34, 197, 94, 0.3);
            color: #86efac;
        }

        .code-input {
            width: 60px;
            height: 60px;
            text-align: center;
            font-size: 24px;
            font-weight: bold;
        }
    </style>
</head>

<body class="font-sans bg-gradient-to-br from-gray-900 via-blue-900 to-purple-900 text-white overflow-x-hidden">
    
    <!-- Navigation -->
    <nav class="fixed top-0 w-full z-50 glass-effect transition-all duration-300" id="navbar">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <!-- Logo -->
                <div class="flex items-center space-x-3">
                    <div class="w-10 h-10 bg-gradient-to-r from-african-gold to-sunset-orange rounded-lg flex items-center justify-center">
                        <i class="fas fa-envelope text-white text-xl"></i>
                    </div>
                    <span class="text-2xl font-bold gradient-text">AfriMail Pro</span>
                </div>
                
                <!-- Desktop Menu -->
                <div class="hidden md:flex items-center space-x-8">
                    <a href="{% url 'homepage' %}" class="hover:text-african-gold transition-colors">Accueil</a>
                    <a href="{% url 'login' %}" class="hover:text-african-gold transition-colors">Connexion</a>
                </div>
                
                <!-- Mobile Menu Button -->
                <button class="md:hidden" id="mobile-menu-btn" aria-label="Menu mobile">
                    <i class="fas fa-bars text-2xl"></i>
                </button>
            </div>
        </div>
        
        <!-- Mobile Menu -->
        <div class="md:hidden hidden bg-gray-900 bg-opacity-95" id="mobile-menu">
            <div class="px-6 py-4 space-y-4">
                <a href="{% url 'homepage' %}" class="block hover:text-african-gold transition-colors">Accueil</a>
                <a href="{% url 'login' %}" class="block hover:text-african-gold transition-colors">Connexion</a>
            </div>
        </div>
    </nav>

    <!-- Forgot Password Section -->
    <section class="relative min-h-screen flex items-center justify-center african-pattern py-20">
        <div class="floating-elements"></div>
        <div class="container mx-auto px-6">
            <div class="max-w-md mx-auto">
                <div class="glass-effect p-8 rounded-2xl shadow-2xl card-hover animate-fade-in">
                    
                    <!-- Progress Bar -->
                    <div class="mb-8">
                        <div class="progress-bar">
                            <div class="progress-fill" id="progressBar" style="width: 33.33%"></div>
                        </div>
                        <div class="flex justify-between mt-2 text-sm text-gray-400">
                            <span id="step1Label" class="text-african-gold">1. Email</span>
                            <span id="step2Label">2. Code</span>
                            <span id="step3Label">3. Nouveau mot de passe</span>
                        </div>
                    </div>

                    <!-- Step 1: Email Verification -->
                    <div id="step1" class="step-visible">
                        <div class="text-center mb-8">
                            <div class="w-20 h-20 bg-gradient-to-r from-african-gold to-sunset-orange rounded-xl flex items-center justify-center mx-auto mb-4">
                                <i class="fas fa-envelope text-white text-3xl"></i>
                            </div>
                            <h1 class="text-3xl font-bold mb-2 gradient-text">Mot de passe oublié</h1>
                            <p class="text-gray-300">Entrez votre adresse email pour recevoir un code de vérification</p>
                        </div>
                        
                        <form class="space-y-6" id="emailForm">
                            <div>
                                <label for="email" class="block text-gray-300 mb-2">Adresse Email</label>
                                <div class="relative">
                                    <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                        <i class="fas fa-envelope text-gray-500"></i>
                                    </div>
                                    <input type="email" id="email" class="w-full bg-gray-800 border border-gray-700 rounded-lg pl-10 pr-4 py-3 focus:outline-none focus:ring-2 focus:ring-african-gold" placeholder="votre@email.com" required>
                                </div>
                                <div id="emailError" class="hidden error-message p-3 rounded-lg mt-2">
                                    <i class="fas fa-exclamation-triangle mr-2"></i>
                                    <span></span>
                                </div>
                            </div>

                            <button type="submit" id="emailSubmitBtn" class="w-full bg-gradient-to-r from-african-gold to-sunset-orange py-4 rounded-full font-semibold hover:scale-105 transition-transform flex items-center justify-center">
                                <i class="fas fa-search mr-2"></i>
                                Vérifier l'email
                            </button>
                        </form>
                        
                        <div class="mt-6 text-center">
                            <p class="text-gray-400">
                                Vous vous souvenez de votre mot de passe? 
                                <a href="{% url 'login' %}" class="font-medium text-african-gold hover:text-sunset-orange">Se connecter</a>
                            </p>
                        </div>
                    </div>

                    <!-- Step 2: Code Verification -->
                    <div id="step2" class="step-hidden">
                        <div class="text-center mb-8">
                            <div class="w-20 h-20 bg-gradient-to-r from-safari-green to-sky-blue rounded-xl flex items-center justify-center mx-auto mb-4">
                                <i class="fas fa-key text-white text-3xl"></i>
                            </div>
                            <h1 class="text-3xl font-bold mb-2 gradient-text">Code de vérification</h1>
                            <p class="text-gray-300">Entrez le code à 6 chiffres envoyé à <span id="emailDisplay" class="text-african-gold font-medium"></span></p>
                        </div>
                        
                        <form class="space-y-6" id="codeForm">
                            <div>
                                <label class="block text-gray-300 mb-4 text-center">Code de vérification</label>
                                <div class="flex justify-center space-x-2">
                                    <input type="text" maxlength="1" class="code-input bg-gray-800 border border-gray-700 rounded-lg focus:outline-none focus:ring-2 focus:ring-african-gold" id="code1">
                                    <input type="text" maxlength="1" class="code-input bg-gray-800 border border-gray-700 rounded-lg focus:outline-none focus:ring-2 focus:ring-african-gold" id="code2">
                                    <input type="text" maxlength="1" class="code-input bg-gray-800 border border-gray-700 rounded-lg focus:outline-none focus:ring-2 focus:ring-african-gold" id="code3">
                                    <input type="text" maxlength="1" class="code-input bg-gray-800 border border-gray-700 rounded-lg focus:outline-none focus:ring-2 focus:ring-african-gold" id="code4">
                                    <input type="text" maxlength="1" class="code-input bg-gray-800 border border-gray-700 rounded-lg focus:outline-none focus:ring-2 focus:ring-african-gold" id="code5">
                                    <input type="text" maxlength="1" class="code-input bg-gray-800 border border-gray-700 rounded-lg focus:outline-none focus:ring-2 focus:ring-african-gold" id="code6">
                                </div>
                                <div id="codeError" class="hidden error-message p-3 rounded-lg mt-4">
                                    <i class="fas fa-exclamation-triangle mr-2"></i>
                                    <span></span>
                                </div>
                            </div>

                            <button type="submit" id="codeSubmitBtn" class="w-full bg-gradient-to-r from-safari-green to-sky-blue py-4 rounded-full font-semibold hover:scale-105 transition-transform flex items-center justify-center">
                                <i class="fas fa-check mr-2"></i>
                                Vérifier le code
                            </button>
                        </form>
                        
                        <div class="mt-6 text-center">
                            <p class="text-gray-400">
                                Vous n'avez pas reçu le code? 
                                <button id="resendCode" class="font-medium text-african-gold hover:text-sunset-orange">Renvoyer</button>
                            </p>
                            <button id="backToEmail" class="text-gray-500 hover:text-gray-300 mt-2">← Retour à l'email</button>
                        </div>
                    </div>

                    <!-- Step 3: Reset Password -->
                    <div id="step3" class="step-hidden">
                        <div class="text-center mb-8">
                            <div class="w-20 h-20 bg-gradient-to-r from-sunset-orange to-earth-brown rounded-xl flex items-center justify-center mx-auto mb-4">
                                <i class="fas fa-lock text-white text-3xl"></i>
                            </div>
                            <h1 class="text-3xl font-bold mb-2 gradient-text">Nouveau mot de passe</h1>
                            <p class="text-gray-300">Créez un nouveau mot de passe sécurisé pour votre compte</p>
                        </div>
                        
                        <form class="space-y-6" id="passwordForm">
                            <div>
                                <label for="newPassword" class="block text-gray-300 mb-2">Nouveau mot de passe</label>
                                <div class="relative">
                                    <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                        <i class="fas fa-lock text-gray-500"></i>
                                    </div>
                                    <input type="password" id="newPassword" class="w-full bg-gray-800 border border-gray-700 rounded-lg pl-10 pr-12 py-3 focus:outline-none focus:ring-2 focus:ring-african-gold" placeholder="••••••••" required minlength="8">
                                    <button type="button" class="absolute inset-y-0 right-0 pr-3 flex items-center" id="toggleNewPassword">
                                        <i class="fas fa-eye text-gray-500"></i>
                                    </button>
                                </div>
                            </div>

                            <div>
                                <label for="confirmPassword" class="block text-gray-300 mb-2">Confirmer le mot de passe</label>
                                <div class="relative">
                                    <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                        <i class="fas fa-lock text-gray-500"></i>
                                    </div>
                                    <input type="password" id="confirmPassword" class="w-full bg-gray-800 border border-gray-700 rounded-lg pl-10 pr-12 py-3 focus:outline-none focus:ring-2 focus:ring-african-gold" placeholder="••••••••" required minlength="8">
                                    <button type="button" class="absolute inset-y-0 right-0 pr-3 flex items-center" id="toggleConfirmPassword">
                                        <i class="fas fa-eye text-gray-500"></i>
                                    </button>
                                </div>
                                <div id="passwordError" class="hidden error-message p-3 rounded-lg mt-2">
                                    <i class="fas fa-exclamation-triangle mr-2"></i>
                                    <span></span>
                                </div>
                                <div id="passwordSuccess" class="hidden success-message p-3 rounded-lg mt-2">
                                    <i class="fas fa-check-circle mr-2"></i>
                                    <span></span>
                                </div>
                            </div>

                            <div class="text-sm text-gray-400">
                                <p class="mb-2">Le mot de passe doit contenir:</p>
                                <ul class="space-y-1 text-xs">
                                    <li class="flex items-center"><i class="fas fa-circle text-xs mr-2"></i> Au moins 8 caractères</li>
                                    <li class="flex items-center"><i class="fas fa-circle text-xs mr-2"></i> Une lettre majuscule</li>
                                    <li class="flex items-center"><i class="fas fa-circle text-xs mr-2"></i> Une lettre minuscule</li>
                                    <li class="flex items-center"><i class="fas fa-circle text-xs mr-2"></i> Un chiffre</li>
                                </ul>
                            </div>

                            <button type="submit" id="passwordSubmitBtn" class="w-full bg-gradient-to-r from-sunset-orange to-earth-brown py-4 rounded-full font-semibold hover:scale-105 transition-transform flex items-center justify-center">
                                <i class="fas fa-save mr-2"></i>
                                Mettre à jour le mot de passe
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Floating 3D Elements -->
        <div class="absolute top-20 left-10 opacity-30 animate-float">
            <div class="w-20 h-20 bg-gradient-to-r from-african-gold to-sunset-orange rounded-xl transform rotate-12"></div>
        </div>
        <div class="absolute bottom-20 right-10 opacity-30 animate-float" style="animation-delay: -3s;">
            <div class="w-16 h-16 bg-gradient-to-r from-safari-green to-sky-blue rounded-full"></div>
        </div>
        <div class="absolute top-1/2 right-20 opacity-20 animate-bounce-gentle">
            <div class="w-12 h-12 bg-gradient-to-r from-sunset-orange to-earth-brown rounded-lg transform rotate-45"></div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-gray-900 py-8">
        <div class="container mx-auto px-6">
            <div class="flex flex-col md:flex-row justify-between items-center">
                <div class="flex items-center space-x-3 mb-4 md:mb-0">
                    <div class="w-8 h-8 bg-gradient-to-r from-african-gold to-sunset-orange rounded-lg flex items-center justify-center">
                        <i class="fas fa-envelope text-white text-sm"></i>
                    </div>
                    <span class="text-xl font-bold gradient-text">AfriMail Pro</span>
                </div>
                
                <div class="flex space-x-6">
                    <a href="#" class="text-gray-400 hover:text-african-gold transition-colors" aria-label="Facebook">
                        <i class="fab fa-facebook-f"></i>
                    </a>
                    <a href="#" class="text-gray-400 hover:text-sky-blue transition-colors" aria-label="Twitter">
                        <i class="fab fa-twitter"></i>
                    </a>
                    <a href="#" class="text-gray-400 hover:text-safari-green transition-colors" aria-label="LinkedIn">
                        <i class="fab fa-linkedin-in"></i>
                    </a>
                    <a href="#" class="text-gray-400 hover:text-sunset-orange transition-colors" aria-label="Instagram">
                        <i class="fab fa-instagram"></i>
                    </a>
                </div>
            </div>
            
            <div class="mt-6 pt-6 border-t border-gray-800 text-center text-gray-400 text-sm">
                <p>© 2024 AfriMail Pro. Tous droits réservés.</p>
            </div>
        </div>
    </footer>

    <!-- Scripts -->
    <script>
        // Mock database of users (replace with actual database verification)
        const mockUsers = [
            'user@afrimail.com',
            'test@exemple.com',
            'admin@afrimail.pro',
            'demo@test.fr'
        ];

        let currentStep = 1;
        let userEmail = '';
        let verificationCode = '';

        document.addEventListener('DOMContentLoaded', function() {
            // Mobile menu toggle
            const mobileMenuBtn = document.getElementById('mobile-menu-btn');
            const mobileMenu = document.getElementById('mobile-menu');
            
            mobileMenuBtn.addEventListener('click', () => {
                mobileMenu.classList.toggle('hidden');
            });

            // Initialize form handlers
            initializeStepHandlers();
            initializeCodeInputs();
            initializePasswordToggles();
            
            // Navbar scroll effect
            const navbar = document.getElementById('navbar');
            function updateNavbar() {
                if (window.scrollY > 50) {
                    navbar.classList.add('shadow-lg', 'bg-gray-900');
                    navbar.classList.remove('bg-opacity-10');
                } else {
                    navbar.classList.remove('shadow-lg', 'bg-gray-900');
                    navbar.classList.add('bg-opacity-10');
                }
            }
            
            window.addEventListener('scroll', updateNavbar);
            updateNavbar();
        });

        function initializeStepHandlers() {
            // Step 1: Email verification
            document.getElementById('emailForm').addEventListener('submit', function(e) {
                e.preventDefault();
                const email = document.getElementById('email').value.trim();
                verifyEmail(email);
            });

            // Step 2: Code verification
            document.getElementById('codeForm').addEventListener('submit', function(e) {
                e.preventDefault();
                const code = getCodeFromInputs();
                verifyCode(code);
            });

            // Step 3: Password reset
            document.getElementById('passwordForm').addEventListener('submit', function(e) {
                e.preventDefault();
                const newPassword = document.getElementById('newPassword').value;
                const confirmPassword = document.getElementById('confirmPassword').value;
                resetPassword(newPassword, confirmPassword);
            });

            // Navigation buttons
            document.getElementById('backToEmail').addEventListener('click', () => {
                goToStep(1);
            });

            document.getElementById('resendCode').addEventListener('click', () => {
                sendVerificationCode(userEmail);
            });
        }

        function initializeCodeInputs() {
            const codeInputs = document.querySelectorAll('.code-input');
            
            codeInputs.forEach((input, index) => {
                input.addEventListener('input', function(e) {
                    // Only allow numbers
                    this.value = this.value.replace(/[^0-9]/g, '');
                    
                    // Auto-focus next input
                    if (this.value && index < codeInputs.length - 1) {
                        codeInputs[index + 1].focus();
                    }
                });

                input.addEventListener('keydown', function(e) {
                    // Handle backspace
                    if (e.key === 'Backspace' && !this.value && index > 0) {
                        codeInputs[index - 1].focus();
                    }
                });

                input.addEventListener('paste', function(e) {
                    e.preventDefault();
                    const pastedData = e.clipboardData.getData('text').replace(/[^0-9]/g, '');
                    
                    for (let i = 0; i < Math.min(pastedData.length, codeInputs.length - index); i++) {
                        codeInputs[index + i].value = pastedData[i];
                    }
                    
                    // Focus last filled input
                    const lastIndex = Math.min(index + pastedData.length - 1, codeInputs.length - 1);
                    codeInputs[lastIndex].focus();
                });
            });
        }

        function initializePasswordToggles() {
            document.getElementById('toggleNewPassword').addEventListener('click', () => {
                togglePasswordVisibility('newPassword', 'toggleNewPassword');
            });

            document.getElementById('toggleConfirmPassword').addEventListener('click', () => {
                togglePasswordVisibility('confirmPassword', 'toggleConfirmPassword');
            });
        }

        function togglePasswordVisibility(inputId, toggleId) {
            const input = document.getElementById(inputId);
            const toggle = document.getElementById(toggleId);
            const icon = toggle.querySelector('i');

            if (input.type === 'password') {
                input.type = 'text';
                icon.classList.remove('fa-eye');
                icon.classList.add('fa-eye-slash');
            } else {
                input.type = 'password';
                icon.classList.remove('fa-eye-slash');
                icon.classList.add('fa-eye');
            }
        }

        function verifyEmail(email) {
            const emailBtn = document.getElementById('emailSubmitBtn');
            const emailError = document.getElementById('emailError');
            
            // Show loading state
            emailBtn.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>Vérification...';
            emailBtn.disabled = true;
            hideError('emailError');

            // Simulate API call delay
            setTimeout(() => {
                // Check if email exists in mock database
                if (mockUsers.includes(email.toLowerCase())) {
                    userEmail = email;
                    sendVerificationCode(email);
                    goToStep(2);
                } else {
                    showError('emailError', 'Cette adresse email n\'est pas associée à un compte AfriMail Pro.');
                    // Shake animation
                    document.getElementById('step1').classList.add('animate-shake');
                    setTimeout(() => {
                        document.getElementById('step1').classList.remove('animate-shake');
                    }, 500);
                }
                
                // Reset button
                emailBtn.innerHTML = '<i class="fas fa-search mr-2"></i>Vérifier l\'email';
                emailBtn.disabled = false;
            }, 1500);
        }

        function sendVerificationCode(email) {
            // Generate random 6-digit code
            verificationCode = Math.floor(100000 + Math.random() * 900000).toString();
            
            // In a real application, you would send this code via email
                        console.log('Verification code for ' + email + ': ' + verificationCode);
            
            // Display the email to the user
            document.getElementById('emailDisplay').textContent = email;
            
            // Show success message (in a real app, you would notify the user to check their email)
            const codeError = document.getElementById('codeError');
            codeError.classList.remove('error-message');
            codeError.classList.add('success-message');
            codeError.querySelector('span').textContent = 'Un code de vérification a été envoyé à votre adresse email.';
            codeError.classList.remove('hidden');
            
            // Hide the message after 5 seconds
            setTimeout(() => {
                codeError.classList.add('hidden');
            }, 5000);
            
            // Clear any previous code inputs
            clearCodeInputs();
        }

        function getCodeFromInputs() {
            let code = '';
            for (let i = 1; i <= 6; i++) {
                code += document.getElementById('code' + i).value;
            }
            return code;
        }

        function clearCodeInputs() {
            for (let i = 1; i <= 6; i++) {
                document.getElementById('code' + i).value = '';
            }
            document.getElementById('code1').focus();
        }

        function verifyCode(code) {
            const codeBtn = document.getElementById('codeSubmitBtn');
            const codeError = document.getElementById('codeError');
            
            // Show loading state
            codeBtn.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>Vérification...';
            codeBtn.disabled = true;
            
            // Reset error state
            codeError.classList.remove('success-message');
            codeError.classList.add('error-message');
            hideError('codeError');

            // Simulate API call delay
            setTimeout(() => {
                if (code === verificationCode) {
                    goToStep(3);
                } else {
                    showError('codeError', 'Le code de vérification est incorrect. Veuillez réessayer.');
                    // Shake animation
                    document.getElementById('step2').classList.add('animate-shake');
                    setTimeout(() => {
                        document.getElementById('step2').classList.remove('animate-shake');
                    }, 500);
                }
                
                // Reset button
                codeBtn.innerHTML = '<i class="fas fa-check mr-2"></i>Vérifier le code';
                codeBtn.disabled = false;
            }, 1500);
        }

        function resetPassword(newPassword, confirmPassword) {
            const passwordBtn = document.getElementById('passwordSubmitBtn');
            const passwordError = document.getElementById('passwordError');
            const passwordSuccess = document.getElementById('passwordSuccess');
            
            // Show loading state
            passwordBtn.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>Mise à jour...';
            passwordBtn.disabled = true;
            hideError('passwordError');
            hideError('passwordSuccess');

            // Validate password
            if (newPassword !== confirmPassword) {
                showError('passwordError', 'Les mots de passe ne correspondent pas.');
                passwordBtn.innerHTML = '<i class="fas fa-save mr-2"></i>Mettre à jour le mot de passe';
                passwordBtn.disabled = false;
                return;
            }

            // Check password strength (basic validation)
            if (newPassword.length < 8) {
                showError('passwordError', 'Le mot de passe doit contenir au moins 8 caractères.');
                passwordBtn.innerHTML = '<i class="fas fa-save mr-2"></i>Mettre à jour le mot de passe';
                passwordBtn.disabled = false;
                return;
            }

            // Simulate API call delay
            setTimeout(() => {
                // In a real application, you would update the password in your database
                console.log('Password updated for ' + userEmail);
                
                // Show success message
                passwordSuccess.querySelector('span').textContent = 'Votre mot de passe a été mis à jour avec succès!';
                passwordSuccess.classList.remove('hidden');
                
                // Redirect to login page after 3 seconds
                setTimeout(() => {
                    window.location.href = 'login.html';
                }, 3000);
            }, 1500);
        }

        function goToStep(step) {
            // Validate step
            if (step < 1 || step > 3) return;
            
            // Hide current step
            document.getElementById('step' + currentStep).classList.remove('step-visible');
            document.getElementById('step' + currentStep).classList.add('step-hidden');
            
            // Show new step
            document.getElementById('step' + step).classList.remove('step-hidden');
            document.getElementById('step' + step).classList.add('step-visible');
            
            // Update progress bar
            const progressPercentage = (step / 3) * 100;
            document.getElementById('progressBar').style.width = progressPercentage + '%';
            
            // Update step labels
            document.querySelectorAll('[id^="step"]Label').forEach((label, index) => {
                if (index + 1 < step) {
                    label.classList.add('text-african-gold');
                } else if (index + 1 === step) {
                    label.classList.add('text-african-gold');
                } else {
                    label.classList.remove('text-african-gold');
                }
            });
            
            currentStep = step;
            
            // Scroll to top of form
            document.getElementById('step' + step).scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        function showError(elementId, message) {
            const element = document.getElementById(elementId);
            element.querySelector('span').textContent = message;
            element.classList.remove('hidden');
        }

        function hideError(elementId) {
            document.getElementById(elementId).classList.add('hidden');
        }
    </script>
</body>
</html>